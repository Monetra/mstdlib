<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mstdlib-1.0.0: About</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mstdlib-1.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">About </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>mstdlib stands for "M Standard Library".</p>
<p>It was created by Main Street Softworks, Inc. for use in their Monetra payment engine. It is designed to be a safe cross platform API for functionality that was commonly used in Monetra and other projects. This library was found to be so useful internally that in 2017 it was decided to release it to the public as open source. Please see the LICENSE file.</p>
<p>To avoid trademark issues the "m" in mstdlib just stands for the letter M. It does not stand for Main Street Softworks, Inc. nor Monetra.</p>
<h1>Rationale/Use </h1>
<p>Mstdlib is designed to provide features not normally found in libc but also to be used in place of libc. Underneath mstdlib uses the system's libc when it makes sense. It is not itself a libc implementation. Though it does provide a number of additional features. Using mstdlib as if it was libc provides benefits such as NULL safety and memory zeroing. That's not to say you can't use libc functions directly, but we encourage avoiding it if at all possible.</p>
<p>Mstdlib marks a number of libc functions as deprecated in favor of mstdlibs versions. Due to features such as NULL safety and secure implementations mstdlib's functions should be preferred. Using a libc function that has been implemented in mstdlib will cause a warning to be generated during compilation. This is to aid in finding libc function (mis)use.</p>
<p>A number of additional functions are provided that are non-standard but often found in some common libc implementations. This ensures consistency across multiple platforms.</p>
<p>To aid with reducing coding errors a number of attribute warnings are set (as supported by the compiler in use). These provide additional hints to the compiler and cause additional warnings to be generated. For example, checking if NULL is passed as a parameter when NULL is not a valid input (mstdlib will prevent a crash in this situation). Or checking if a function's return value is never set to a variable.</p>
<p>Using mstdlib means only <a class="el" href="mstdlib_8h_source.html">mstdlib.h</a> and mstdlib_*.h files need to be #include(d). This removes the need to determine what functions belong to which header file.</p>
<p>Mstdlib headers should reference the mstdlib directory. For example: </p><pre class="fragment">#include &lt;mstdlib/mstdlib.h&gt;
#include &lt;mstdlib/mstdlib_thread.h&gt;
</pre><p>Since threading requires the base mstdlib you only need to include <code><a class="el" href="mstdlib__thread_8h_source.html">mstdlib_thread.h</a></code>. All mstdlib functionality will be available because <code><a class="el" href="mstdlib__thread_8h_source.html">mstdlib_thread.h</a></code> itself includes <code><a class="el" href="mstdlib_8h_source.html">mstdlib.h</a></code>. That said, this behavior should not be relied on. Always include the mstdlib components you intend to use.</p>
<h1>Goals </h1>
<p>Provide an easy to use C library that is first and foremost secure. It should provide common functionality to make development easier and faster. It should work across multiple platforms. There shouldn't be any surprises.</p>
<h2>1. Secure </h2>
<ul>
<li>Make all functions NULL safe.</li>
<li>Provide helper objects to prevent common vulnerabilities such as buffer overflow. For example <code>M_buf</code> and <code>M_parser</code>.</li>
<li>Type safety is heavily pushed. Generic implementations are provided for creating type safe wrappers. Use of void pointers should be limited.</li>
<li>M_malloc and M_free are wrappers around the system calls but M_free will zero the memory. This is to prevent sensitive data (credit card numbers, encryption keys) from being accessible longer than absolutely necessary.</li>
<li>Data types/formats/parsers were designed to prevent known attack vectors.</li>
<li>Build with high warning levels and fix any thing reported.</li>
<li>Use clang's static analyzer so all code is clang clean.</li>
<li>Consistent naming and design patterns that make an object's use and life clear. Such as create and destroy naming.</li>
<li>Prefer code that is easy to read over clever.</li>
</ul>
<h2>2. Cross platform </h2>
<ul>
<li>All features (when feasible) should work across multiple OSs.</li>
<li>The same objects and functions should work the same on all OSs.</li>
<li>Works on:<ul>
<li>Linux</li>
<li>OS X</li>
<li>Windows</li>
<li>FreeBSD</li>
<li>AIX</li>
<li>Solaris</li>
<li>SCO</li>
<li>Android</li>
<li>iOS</li>
</ul>
</li>
<li>Tested with multiple compilers and compiler versions.</li>
</ul>
<h2>3. Small </h2>
<ul>
<li>Don't try to create a library with everything including the kitchen sink. This isn't mean to be an all encompassing library like Java or Python's standard libraries. At least this was the original idea but...</li>
<li>Features included must be commonly used and useful.</li>
<li>Use separate modules that are layered in order to reduce the overall size of the library if only some features are needed.</li>
</ul>
<h1>Building </h1>
<p>CMake is the preferred method to build and should be used whenever possible. However, CMake is not available on all supported platforms. Autotools is also supported for Unix systems. NMake Makefiles are also available for Windows. Autotools and NMake Makefiles are provided only as a fallback when CMake cannot be used. That said, Autotools and NMake Make files can lag behind being updated and there is no timeline on how long they will be supported.</p>
<p>The following features are supported by each build system:</p>
<table class="doxtable">
<tr>
<th align="left">Feature </th><th align="center">CMake </th><th align="center">Autotools </th><th align="center">NMake Makefiles  </th></tr>
<tr>
<td align="left">Shared build </td><td align="center">Y </td><td align="center">Y </td><td align="center">Y </td></tr>
<tr>
<td align="left">Static build </td><td align="center">Y </td><td align="center">Y </td><td align="center">N </td></tr>
<tr>
<td align="left">Disabling building non-base components </td><td align="center">Y </td><td align="center">Y </td><td align="center">N </td></tr>
<tr>
<td align="left">Installation (header and library) </td><td align="center">Y </td><td align="center">Y </td><td align="center">N </td></tr>
<tr>
<td align="left">Disabling header installation </td><td align="center">Y </td><td align="center">N </td><td align="center">N </td></tr>
<tr>
<td align="left">Disabling library installation </td><td align="center">Y </td><td align="center">N </td><td align="center">N </td></tr>
<tr>
<td align="left">Tests </td><td align="center">Y </td><td align="center">Y </td><td align="center">N </td></tr>
</table>
<h2>CMake </h2>
<pre class="fragment">$ mkdir build
$ cd build
$ cmake -DCMAKE_BUILD_TYPE=&lt;DEBUG|RELEASE&gt; ..
$ make
</pre><h2>Dependencies </h2>
<h3>Required</h3>
<h4>C-Ares</h4>
<p>The I/O module uses c-ares for DNS resolution as part of its network support. It is recommended to simply extract the latest c-ares source into the mstdlib source tree under: </p><pre class="fragment">thirdparty/c-ares
</pre><p>If it exists, it will be built as part of mstdlib and statically linked.</p>
<p>Otherwise, mstdlib will attempt to search for C-Ares on the system. Use <code>-Dc_ares_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>OpenSSL</h4>
<p>The TLS subsystem uses OpenSSL 1.0.1 or higher for the underlying cryptographic routines. It is expected to be installed on the system. Pass <code>-DOPENSSL_ROOT_DIR=&lt;path&gt;</code> to cmake if the location is in a non-standard path.</p>
<h3>Optional</h3>
<h4>SQLite</h4>
<p>SQLite is used to build the SQLite plugin for the SQL subsystem. It is recommended to download the latest SQLite Amalgamation package from sqlite.org and extract it into the mstdlib source tree under: </p><pre class="fragment">thirdparty/sqlite-amalgamation
</pre><p>If it exists, it will be built as part of mstdlib and statically linked.</p>
<p>Otherwise, mstdlib will attempt to search for SQLite on the system. Use <code>-DSQLITE_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>MySQL Client Library/MariaDB Connector C</h4>
<p>The MySQL Client Library, or MariaDB Connector C (recommended) are used to build the MySQL plugin for the SQL subsystem. Mstdlib will attempt to search for one of these libraries on the system, use <code>-DMYSQL_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>PostgreSQL Client Library</h4>
<p>The PostgreSQL Client Library is used to build the PostgreSQL plugin for the SQL subsystem. v9.2 or higher is required. Mstdlib will attempt to search for the library on the system, use <code>-DPOSTGRESQL_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>Oracle Client Library</h4>
<p>The Oracle Client Library is used to build the Oracle plugin for the SQL subsystem. v11.2 or higher is required. Mstdlib will attempt to search for the library on the system, use <code>-DORACLE_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>ODBC (UnixODBC, iODBC, or Windows ODBC)</h4>
<p>The ODBC libraries are used to build the ODBC plugin for the SQL subsystem. Mstdlib will attempt to search for one of the available options, use <code>-DODBC_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h4>DB2</h4>
<p>The DB2 libraries are used to build the DB2 plugin for the SQL subsystem. Mstdlib will attempt to search for the library on the system, use <code>-DDB2_DIR=&lt;path&gt;</code> if installed to a non-standard location.</p>
<h2>Building docs </h2>
<p>Requires doxygen is installed and found. Documentation will be build automatically when the library is built.</p>
<h2>Running tests </h2>
<p>Requires libcheck is installed and found. </p><pre class="fragment">$ make check
</pre><p>Logs will be in: build/test/test_name.log.</p>
<h2>Debugging tests </h2>
<pre class="fragment">$ gdb ./bin/test
(gdb) set environment CK_FORK=no
(gdb) run
</pre><h2>Running tests though Valgrind </h2>
<p>Tests by default will be run though valgrind if it is installed on the system. Logs with valgrind output will be in: build/test/test_name-valgrind.log</p>
<h2>Build Options </h2>
<table class="doxtable">
<tr>
<th>Option </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>MSTDLIB_STATIC </td><td>Build static libs. </td><td>OFF </td></tr>
<tr>
<td>MSTDLIB_STATIC_PIC </td><td>Build static libs as PIC. </td><td>OFF </td></tr>
<tr>
<td>MSTDLIB_INSTALL_LOCATION_LIBS </td><td>Alternative install location to use instead of CMAKE_INSTALL_PREFIX. Useful for chain building and installing into a packing sub directory. </td><td>N/A </td></tr>
<tr>
<td>MSTDLIB_INSTALL_LOCATION_HEADERS </td><td>Alternative install location to use instead of CMAKE_INSTALL_PREFIX. Useful for chain building and installing into a packing sub directory. </td><td>N/A </td></tr>
<tr>
<td>MSTDLIB_INSTALL_HEADERS </td><td>Install headers. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_INSTALL_LIBS </td><td>Install libraries. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_TESTS </td><td>Build tests. </td><td>ON </td></tr>
<tr>
<td>M_ASAN </td><td>Build with Address Sanitizer (compiler support required) </td><td>OFF </td></tr>
<tr>
<td>MSTDLIB_USE_VALGRIND </td><td>Run tests with valgrind when running "make check". </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_THREAD </td><td>Build thread module. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_IO </td><td>Build io module. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_TLS </td><td>Build tls module. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_LOG </td><td>Build log module. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL </td><td>Build sql module. </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_MYSQL </td><td>Build MySQL/MariaDB plugin for sql </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_SQLITE </td><td>Build SQLite plugin for SQL </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_POSTGRESQL </td><td>Build PostgreSQL plugin for SQL </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_ORACLE </td><td>Build Oracle plugin for SQL </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_ODBC </td><td>Build ODBC plugin for SQL </td><td>ON </td></tr>
<tr>
<td>MSTDLIB_BUILD_SQL_DB2 </td><td>Build DB2 plugin for SQL </td><td>ON </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 20 2018 12:46:13 for Mstdlib-1.0.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
