<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mstdlib-1.0.0: SQL Transaction Handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mstdlib-1.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__m__sql__trans.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SQL Transaction Handling<div class="ingroups"><a class="el" href="group__m__sql.html">SQL Subsystem</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gae1f08c66c77af1b890d594c14c6f0a25"><td class="memItemLeft" align="right" valign="top">typedef struct M_sql_trans&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a></td></tr>
<tr class="separator:gae1f08c66c77af1b890d594c14c6f0a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadda34ed69bffbcf3a1079d94effa1725"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#gadda34ed69bffbcf3a1079d94effa1725">M_sql_trans_commands_t</a>) (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans, void *arg, char *error, size_t error_size)</td></tr>
<tr class="separator:gadda34ed69bffbcf3a1079d94effa1725"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga38ac042e25fb1159dee3474fb024485d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a> { <br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da3659eed347d953d4f76d361c366ace36">M_SQL_ISOLATION_UNKNOWN</a> = 0, 
<br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da51e7ca2b593aa8006a27c8dd29032d73">M_SQL_ISOLATION_READUNCOMMITTED</a> = 1, 
<br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da03feedac70e32a8ca2404332b085fb00">M_SQL_ISOLATION_READCOMMITTED</a> = 2, 
<br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485dac3dd9458c5a33651d2479fc43a7d6a1e">M_SQL_ISOLATION_REPEATABLEREAD</a> = 3, 
<br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da9e9bc37dfd24b5412e91b82ee8e736ef">M_SQL_ISOLATION_SNAPSHOT</a> = 4, 
<br />
&#160;&#160;<a class="el" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da274d1d0e1977c51cbc2f9bdf576eab32">M_SQL_ISOLATION_SERIALIZABLE</a> = 5
<br />
 }</td></tr>
<tr class="separator:ga38ac042e25fb1159dee3474fb024485d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6dbb6e001e37950596ccc40f05cedce9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#ga6dbb6e001e37950596ccc40f05cedce9">M_sql_trans_begin</a> (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> **trans, <a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *pool, <a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a> isolation, char *error, size_t error_size)</td></tr>
<tr class="separator:ga6dbb6e001e37950596ccc40f05cedce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacaa91538f6719d58be8991dd15e2788a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback</a> (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans)</td></tr>
<tr class="separator:gacaa91538f6719d58be8991dd15e2788a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22fb450587f6dd829e3ad6b5ac4df3f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit</a> (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans, char *error, size_t error_size)</td></tr>
<tr class="separator:ga22fb450587f6dd829e3ad6b5ac4df3f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63477b2bd1f89f36d72d18a0e63591dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#ga63477b2bd1f89f36d72d18a0e63591dc">M_sql_trans_execute</a> (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans, <a class="el" href="group__m__sql__stmt.html#ga4a726e8b7d1b5cffc6f92fdb3e8fb498">M_sql_stmt_t</a> *stmt)</td></tr>
<tr class="separator:ga63477b2bd1f89f36d72d18a0e63591dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad028a43c09743a7c4996404c019da128"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process</a> (<a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *pool, <a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a> isolation, <a class="el" href="group__m__sql__trans.html#gadda34ed69bffbcf3a1079d94effa1725">M_sql_trans_commands_t</a> cmd, void *cmd_arg, char *error, size_t error_size)</td></tr>
<tr class="separator:gad028a43c09743a7c4996404c019da128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9903fe845c0f6c26628cec6aa6bbf7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__sql__trans.html#gaf9903fe845c0f6c26628cec6aa6bbf7b">M_sql_trans_get_pool</a> (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans)</td></tr>
<tr class="separator:gaf9903fe845c0f6c26628cec6aa6bbf7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>SQL Transaction Handling </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gae1f08c66c77af1b890d594c14c6f0a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1f08c66c77af1b890d594c14c6f0a25">&#9670;&nbsp;</a></span>M_sql_trans_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct M_sql_trans <a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Object holding the state for an active transaction </p>

</div>
</div>
<a id="gadda34ed69bffbcf3a1079d94effa1725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadda34ed69bffbcf3a1079d94effa1725">&#9670;&nbsp;</a></span>M_sql_trans_commands_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>(* M_sql_trans_commands_t) (<a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans, void *arg, char *error, size_t error_size)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function prototype called by <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a>.</p>
<p>Inside the function created, the integrator should perform each step of the SQL transaction, and if an error occurs, return the appropriate error condition, whether it is an error condition as returned by <a class="el" href="group__m__sql__trans.html#ga63477b2bd1f89f36d72d18a0e63591dc">M_sql_trans_execute()</a>, which should be passed through unmodified, or an internally generated error condition if internal logic fails. For user-logic generated errors, special error conditions of <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea5e58b8b9f87a6903d095f23704e9b1c4">M_SQL_ERROR_USER_SUCCESS</a>, <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ead2b4ab4167e37e152a2d786e0a687ed8">M_SQL_ERROR_USER_RETRY</a> and <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea65adfae56a8b6eb303401f4511acaf74">M_SQL_ERROR_USER_FAILURE</a> exist to more accurately identify the condition rather than attempting to map to the generic SQL subsystem condtions.</p>
<dl class="section note"><dt>Note</dt><dd>The function should expect to be called potentially multiple times, so state tracking must be reset on entry to this user-specified function. If a rollback or connectivity failure condition is met, it will automatically be called again.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function should NEVER call <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> or <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> as that is handled internally by the helper <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Pointer to initialized transaction object to use to execute the transaction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>User-specified argument used for storing metadata about the flow/process. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>User-supplied error buffer to output error message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error_size</td><td>Size of user-supplied error buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> or <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea5e58b8b9f87a6903d095f23704e9b1c4">M_SQL_ERROR_USER_SUCCESS</a> on successful completion, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> error conditions. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga38ac042e25fb1159dee3474fb024485d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38ac042e25fb1159dee3474fb024485d">&#9670;&nbsp;</a></span>M_sql_isolation_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transaction isolation levels </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485da3659eed347d953d4f76d361c366ace36"></a>M_SQL_ISOLATION_UNKNOWN&#160;</td><td class="fielddoc"><p>Unknown, used for error conditions, never set </p>
</td></tr>
<tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485da51e7ca2b593aa8006a27c8dd29032d73"></a>M_SQL_ISOLATION_READUNCOMMITTED&#160;</td><td class="fielddoc"><p>Read Uncommitted </p>
</td></tr>
<tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485da03feedac70e32a8ca2404332b085fb00"></a>M_SQL_ISOLATION_READCOMMITTED&#160;</td><td class="fielddoc"><p>Read Committed </p>
</td></tr>
<tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485dac3dd9458c5a33651d2479fc43a7d6a1e"></a>M_SQL_ISOLATION_REPEATABLEREAD&#160;</td><td class="fielddoc"><p>Repeatable Read </p>
</td></tr>
<tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485da9e9bc37dfd24b5412e91b82ee8e736ef"></a>M_SQL_ISOLATION_SNAPSHOT&#160;</td><td class="fielddoc"><p>Snapshot </p>
</td></tr>
<tr><td class="fieldname"><a id="gga38ac042e25fb1159dee3474fb024485da274d1d0e1977c51cbc2f9bdf576eab32"></a>M_SQL_ISOLATION_SERIALIZABLE&#160;</td><td class="fielddoc"><p>Serializable </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga6dbb6e001e37950596ccc40f05cedce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6dbb6e001e37950596ccc40f05cedce9">&#9670;&nbsp;</a></span>M_sql_trans_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> M_sql_trans_begin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> **&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a>&#160;</td>
          <td class="paramname"><em>isolation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>error_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Begin a new SQL transaction at the requested isolation level.</p>
<p>Beginning a new transaction will reserve an SQL connection from the pool until either a rollback or commit is performed. Callers in most cases should not start more than one SQL transaction per thread as it could lead to deadlocks waiting on a connection to become available if insufficient connections are available in the pool.</p>
<p>In order to clean up the returned transaction handle, a caller must call either <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> or <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> as appropriate.</p>
<dl class="section note"><dt>Note</dt><dd>It is recommended to use the <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a> helper rather than calling <a class="el" href="group__m__sql__trans.html#ga6dbb6e001e37950596ccc40f05cedce9">M_sql_trans_begin()</a>, <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> or <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> yourself.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">trans</td><td>Returns initialized transaction handle to be used for queries. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>Initialized <a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isolation</td><td>Requested isolation level. The database may choose the closest match if the isolation level requested is not supported. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>User-supplied buffer to hold error message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error_size</td><td>Size of User-supplied buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> on success, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> results on failure. </dd></dl>

</div>
</div>
<a id="gacaa91538f6719d58be8991dd15e2788a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacaa91538f6719d58be8991dd15e2788a">&#9670;&nbsp;</a></span>M_sql_trans_rollback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> M_sql_trans_rollback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *&#160;</td>
          <td class="paramname"><em>trans</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rollback an SQL transaction.</p>
<p>This function should be called if the caller needs to cancel the transaction, or must be called to clean up the <a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> handle when an unrecoverable error has occurred such as a server disconnect or deadlock.</p>
<p>The passed in trans handle will be destroyed regardless if this function returns success or fail.</p>
<dl class="section note"><dt>Note</dt><dd>It is recommended to use the <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a> helper rather than calling <a class="el" href="group__m__sql__trans.html#ga6dbb6e001e37950596ccc40f05cedce9">M_sql_trans_begin()</a>, <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> or <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> yourself.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Initialized transaction handle that will be used to rollback the pending transaction, and will be will be destroyed automatically upon return of this function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> on success, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> results on failure. </dd></dl>

</div>
</div>
<a id="ga22fb450587f6dd829e3ad6b5ac4df3f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga22fb450587f6dd829e3ad6b5ac4df3f2">&#9670;&nbsp;</a></span>M_sql_trans_commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> M_sql_trans_commit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>error_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Commit a pending SQL transaction.</p>
<p>Any statements executed against the transaction handle will not be applied to the database until this command is called.</p>
<p>The associated transaction handle will be automatically destroyed regardless if this function returns success or fail. If a failure occurs, the caller must assume the transaction was NOT applied (e.g. rolled back).</p>
<dl class="section note"><dt>Note</dt><dd>It is recommended to use the <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a> helper rather than calling <a class="el" href="group__m__sql__trans.html#ga6dbb6e001e37950596ccc40f05cedce9">M_sql_trans_begin()</a>, <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> or <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> yourself.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Initialized transaction handle that will be used to commit the pending transaction, and will be will be destroyed automatically upon return of this function. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>User-supplied buffer to hold error message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error_size</td><td>Size of User-supplied buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> on success, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> results on failure. </dd></dl>

</div>
</div>
<a id="ga63477b2bd1f89f36d72d18a0e63591dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga63477b2bd1f89f36d72d18a0e63591dc">&#9670;&nbsp;</a></span>M_sql_trans_execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> M_sql_trans_execute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__sql__stmt.html#ga4a726e8b7d1b5cffc6f92fdb3e8fb498">M_sql_stmt_t</a> *&#160;</td>
          <td class="paramname"><em>stmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Execute a query against the database that is part of an open transaction. This request will not automatically commit and must be manually committed via <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a>.</p>
<p>Must call <a class="el" href="group__m__sql__stmt.html#ga21b87121fac2d2433a2f363e69139965">M_sql_stmt_prepare()</a> or <a class="el" href="group__m__sql__stmt.html#ga70c41894d66a3309f0304d1eee7f0688">M_sql_stmt_prepare_buf()</a> prior to execution. Must also bind any parameters using <a class="el" href="group__m__sql__stmt__bind.html">M_sql_stmt_bind_*() </a> series of functions.</p>
<p>This function will NOT destroy the passed in <a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> object, it is kept open so additional statements can be executed within the same transaction. If NOT using the <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a> helper, it is the caller's responsibility to call <a class="el" href="group__m__sql__trans.html#ga22fb450587f6dd829e3ad6b5ac4df3f2">M_sql_trans_commit()</a> or <a class="el" href="group__m__sql__trans.html#gacaa91538f6719d58be8991dd15e2788a">M_sql_trans_rollback()</a> as appropriate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Initialized <a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stmt</td><td>Initialized and prepared <a class="el" href="group__m__sql__stmt.html#ga4a726e8b7d1b5cffc6f92fdb3e8fb498">M_sql_stmt_t</a> object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> on success, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> values on failure. </dd></dl>

</div>
</div>
<a id="gad028a43c09743a7c4996404c019da128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad028a43c09743a7c4996404c019da128">&#9670;&nbsp;</a></span>M_sql_trans_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> M_sql_trans_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#ga38ac042e25fb1159dee3474fb024485d">M_sql_isolation_t</a>&#160;</td>
          <td class="paramname"><em>isolation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gadda34ed69bffbcf3a1079d94effa1725">M_sql_trans_commands_t</a>&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cmd_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>error_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function for processing a sequence of SQL commands as a single atomic operation, while automatically handling things like rollback and connectivity failure situations.</p>
<dl class="section warning"><dt>Warning</dt><dd>The user-supplied function being called should expect to be called, potentially, multiple times when errors occur. State MUST NOT be maintained from call to call or risk having inconstent data.</dd></dl>
<p>Usage Example: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line">   M_int64 id;</div><div class="line">   M_int64 inc;</div><div class="line">   M_int64 result;</div><div class="line">} my_counter_metadata_t;</div><div class="line"></div><div class="line"><span class="comment">// Table: CREATE TABLE counters (id INTEGER, val INTEGER, PRIMARY KEY(id))</span></div><div class="line"><span class="comment">// Increment requested id by requested amount</span></div><div class="line"><span class="keyword">static</span> <a class="code" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> my_counter_inc(<a class="code" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *trans, <span class="keywordtype">void</span> *arg, <span class="keywordtype">char</span> *error, <span class="keywordtype">size_t</span> error_size)</div><div class="line">{</div><div class="line">  my_counter_metadata_t *data     = arg;</div><div class="line">  <a class="code" href="group__m__sql__stmt.html#ga4a726e8b7d1b5cffc6f92fdb3e8fb498">M_sql_stmt_t</a>          *stmt;</div><div class="line">  <a class="code" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>          err;</div><div class="line">  M_int64                curr_val = 0;</div><div class="line">  <a class="code" href="group__m__buf.html#ga6c543ecf0004fc310faa23c6ed8b267f">M_buf_t</a>               *query;</div><div class="line"></div><div class="line">  <a class="code" href="group__m__mem.html#ga12f125e84df307ef19f5d418b734202c">M_mem_set</a>(error, 0, error_size);</div><div class="line"></div><div class="line">  <span class="comment">// Retrieve current value for id - don&#39;t forget to use update locks!</span></div><div class="line">  stmt  = <a class="code" href="group__m__sql__stmt.html#ga744a85528377cd1f7ce17480a2863917">M_sql_stmt_create</a>();</div><div class="line">  query = <a class="code" href="group__m__buf.html#ga2031dcfdfa76f5feb5a59c8e7ac155d0">M_buf_create</a>();</div><div class="line">  <a class="code" href="group__m__buf.html#gad226a7199f864ff6a630dc7f16508c30">M_buf_add_str</a>(query, <span class="stringliteral">&quot;SELECT \&quot;val\&quot; FROM \&quot;counters\&quot;&quot;</span>);</div><div class="line">  <a class="code" href="group__m__sql__query.html#ga3ee5a5d66a727e45d2918137266b4d74">M_sql_query_append_updlock</a>(<a class="code" href="group__m__sql__trans.html#gaf9903fe845c0f6c26628cec6aa6bbf7b">M_sql_trans_get_pool</a>(trans), query, <a class="code" href="group__m__sql__query.html#gga6ebebe6fd69e22bb87d506b2c7e4e8f0ad5d2d238b6f95c5998316db53fedb970">M_SQL_QUERY_UPDLOCK_TABLE</a>);</div><div class="line">  <a class="code" href="group__m__buf.html#gad226a7199f864ff6a630dc7f16508c30">M_buf_add_str</a>(query, <span class="stringliteral">&quot; WHERE \&quot;id\&quot; = ?&quot;</span>);</div><div class="line">  <a class="code" href="group__m__sql__query.html#ga3ee5a5d66a727e45d2918137266b4d74">M_sql_query_append_updlock</a>(<a class="code" href="group__m__sql__trans.html#gaf9903fe845c0f6c26628cec6aa6bbf7b">M_sql_trans_get_pool</a>(trans), query, <a class="code" href="group__m__sql__query.html#gga6ebebe6fd69e22bb87d506b2c7e4e8f0aff7c6763b3ed0ab24f605e8fddf4091a">M_SQL_QUERY_UPDLOCK_QUERYEND</a>);</div><div class="line">  <a class="code" href="group__m__sql__stmt.html#ga70c41894d66a3309f0304d1eee7f0688">M_sql_stmt_prepare_buf</a>(stmt, query);</div><div class="line">  <a class="code" href="group__m__sql__stmt__bind.html#ga98a115b01097da82df3e73445e92fed7">M_sql_stmt_bind_int64</a>(stmt, data-&gt;id);</div><div class="line">  err  = <a class="code" href="group__m__sql__trans.html#ga63477b2bd1f89f36d72d18a0e63591dc">M_sql_trans_execute</a>(trans, stmt);</div><div class="line">  <span class="keywordflow">if</span> (err != <a class="code" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a>)</div><div class="line">    <span class="keywordflow">goto</span> done;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__m__sql__stmt__result.html#gaa62223cad30755529c51fcda566e25d9">M_sql_stmt_result_int64</a>(stmt, 0, 0, &amp;curr_val) != <a class="code" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a>) {</div><div class="line">    <a class="code" href="group__m__fmt.html#ga148cb889ab2737a09ebf313e7a3d454b">M_snprintf</a>(error, error_size, <span class="stringliteral">&quot;id %lld not found&quot;</span>, data-&gt;id);</div><div class="line">    err = M_SQL_ERROR_QUERY_FAILED;</div><div class="line">    <span class="keywordflow">goto</span> done;</div><div class="line">  }</div><div class="line">  <a class="code" href="group__m__sql__stmt.html#gac33c17989ab52b819ea8a2d5c2962c51">M_sql_stmt_destroy</a>(stmt);</div><div class="line"></div><div class="line">  <span class="comment">// Increment the value for the id</span></div><div class="line">  data-&gt;result = curr_val + data-&gt;inc;</div><div class="line">  stmt = <a class="code" href="group__m__sql__stmt.html#ga744a85528377cd1f7ce17480a2863917">M_sql_stmt_create</a>();</div><div class="line">  <a class="code" href="group__m__sql__stmt.html#ga21b87121fac2d2433a2f363e69139965">M_sql_stmt_prepare</a>(stmt, <span class="stringliteral">&quot;UPDATE \&quot;counters\&quot; SET \&quot;val\&quot; = ? WHERE \&quot;id\&quot; = ?&quot;</span>);</div><div class="line">  <a class="code" href="group__m__sql__stmt__bind.html#ga98a115b01097da82df3e73445e92fed7">M_sql_stmt_bind_int64</a>(stmt, data-&gt;result);</div><div class="line">  <a class="code" href="group__m__sql__stmt__bind.html#ga98a115b01097da82df3e73445e92fed7">M_sql_stmt_bind_int64</a>(stmt, data-&gt;id);</div><div class="line">  err  = <a class="code" href="group__m__sql__trans.html#ga63477b2bd1f89f36d72d18a0e63591dc">M_sql_trans_execute</a>(trans, stmt);</div><div class="line">  <span class="keywordflow">if</span> (err != <a class="code" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a>)</div><div class="line">    <span class="keywordflow">goto</span> done;</div><div class="line"></div><div class="line">done:</div><div class="line">  <span class="keywordflow">if</span> (err != <a class="code" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> &amp;&amp; <a class="code" href="group__m__str__check.html#ga530dc6e198ebf9e5c30bc7a28ea4567d">M_str_isempty</a>(error)) {</div><div class="line">    <a class="code" href="group__m__fmt.html#ga148cb889ab2737a09ebf313e7a3d454b">M_snprintf</a>(error, error_size, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="group__m__sql__stmt.html#ga08eaa960f3acebe383ed05cd4d749b3f">M_sql_stmt_get_error_string</a>(stmt));</div><div class="line">  }</div><div class="line">  <a class="code" href="group__m__sql__stmt.html#gac33c17989ab52b819ea8a2d5c2962c51">M_sql_stmt_destroy</a>(stmt);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> err;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> run_txn(<a class="code" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> *pool)</div><div class="line">{</div><div class="line">  my_counter_metadata_t data;</div><div class="line">  <a class="code" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a>         err;</div><div class="line">  <span class="keywordtype">char</span>                  msg[256];</div><div class="line"></div><div class="line">  data.id     = 5;</div><div class="line">  data.inc    = 25;</div><div class="line">  data.result = 0;</div><div class="line"></div><div class="line">  err = <a class="code" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process</a>(pool, <a class="code" href="group__m__sql__trans.html#gga38ac042e25fb1159dee3474fb024485da274d1d0e1977c51cbc2f9bdf576eab32">M_SQL_ISOLATION_SERIALIZABLE</a>, my_counter_inc, &amp;data, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">  <span class="keywordflow">if</span> (err != <a class="code" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a>) {</div><div class="line">    <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;Error: %s: %s\n&quot;</span>, <a class="code" href="group__m__sql__error.html#ga737da880cae25712e80590f755629717">M_sql_error_string</a>(err), msg);</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line">  <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;Success! Final result: %lld\n&quot;</span>, data.result);</div><div class="line">}</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>Initialized and started pool object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isolation</td><td>Requested isolation level. The database may choose the closest match if the isolation level requested is not supported. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmd</td><td>User-specified function to call to step through the sequence of SQL commands to run as part of the transaction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmd_arg</td><td>Argument to pass to User-specified function for metadata about the command(s) being executed. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>User-supplied error buffer to output error message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error_size</td><td>Size of user-supplied error buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea4321145ef534b2263011566a66b8bef8">M_SQL_ERROR_SUCCESS</a> if executed to completion, or one of the <a class="el" href="group__m__sql__error.html#gaae10ff11eb7d5583afcffa6ec87c753e">M_sql_error_t</a> fatal errors on failure (but never <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea623e81ccfdf15e28336c45d75bc095e2">M_SQL_ERROR_QUERY_DEADLOCK</a> or <a class="el" href="group__m__sql__error.html#ggaae10ff11eb7d5583afcffa6ec87c753ea74dc85f97f133dda96c31bc36e3747a3">M_SQL_ERROR_CONN_LOST</a> as those are automatic retry events) </dd></dl>

</div>
</div>
<a id="gaf9903fe845c0f6c26628cec6aa6bbf7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9903fe845c0f6c26628cec6aa6bbf7b">&#9670;&nbsp;</a></span>M_sql_trans_get_pool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a>* M_sql_trans_get_pool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__sql__trans.html#gae1f08c66c77af1b890d594c14c6f0a25">M_sql_trans_t</a> *&#160;</td>
          <td class="paramname"><em>trans</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the <a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> object from a transaction handle typically used within <a class="el" href="group__m__sql__trans.html#gad028a43c09743a7c4996404c019da128">M_sql_trans_process()</a> for using the SQL helpers like <a class="el" href="group__m__sql__query.html#ga3ee5a5d66a727e45d2918137266b4d74">M_sql_query_append_updlock()</a> and <a class="el" href="group__m__sql__query.html#ga70c65566ff6270f731ef0751c1a9cf39">M_sql_query_append_bitop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Transaction object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__m__sql__conn.html#ga36847634817b89efb01054d49e3c6352">M_sql_connpool_t</a> object </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 20 2018 12:46:13 for Mstdlib-1.0.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
