<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mstdlib-1.0.0: Memory Buffer Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mstdlib-1.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__m__log__membuf.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Memory Buffer Module<div class="ingroups"><a class="el" href="group__m__log.html">Logging Subsystem</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab0d5c672f055a436336dabe9850d4426"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__log__common.html#gab5f4f197e827f0ecab0b79f0f2478672">M_log_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__log__membuf.html#gab0d5c672f055a436336dabe9850d4426">M_log_module_add_membuf</a> (<a class="el" href="group__m__log__common.html#gad41859c2eab8886cfdebb82ac5ba1f8d">M_log_t</a> *log, size_t buf_size, M_uint64 buf_time_s, <a class="el" href="group__m__log__common.html#gacfe40a05708b4c96cc13e85169b20743">M_log_expire_cb</a> expire_cb, void *expire_thunk, <a class="el" href="group__m__log__common.html#gaa367697cdf319431c22adec6f4e08c53">M_log_module_t</a> **out_mod)</td></tr>
<tr class="separator:gab0d5c672f055a436336dabe9850d4426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadeab6519c8e80ef50edd2a6c46a57f15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__log__common.html#gab5f4f197e827f0ecab0b79f0f2478672">M_log_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__log__membuf.html#gadeab6519c8e80ef50edd2a6c46a57f15">M_log_module_take_membuf</a> (<a class="el" href="group__m__log__common.html#gad41859c2eab8886cfdebb82ac5ba1f8d">M_log_t</a> *log, <a class="el" href="group__m__log__common.html#gaa367697cdf319431c22adec6f4e08c53">M_log_module_t</a> *module, <a class="el" href="group__m__buf.html#ga6c543ecf0004fc310faa23c6ed8b267f">M_buf_t</a> **out_buf)</td></tr>
<tr class="separator:gadeab6519c8e80ef50edd2a6c46a57f15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions to enable logging sensitive data to a temporary memory buffer.</p>
<p>Membuf modules only accept messages until they are full, then they stop accepting messages and hang out in memory until they're either explicitly retrieved by the caller with <a class="el" href="group__m__log__membuf.html#gadeab6519c8e80ef50edd2a6c46a57f15">M_log_module_take_membuf()</a>, or they reach their expiration time and are automatically destroyed. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gab0d5c672f055a436336dabe9850d4426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab0d5c672f055a436336dabe9850d4426">&#9670;&nbsp;</a></span>M_log_module_add_membuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__log__common.html#gab5f4f197e827f0ecab0b79f0f2478672">M_log_error_t</a> M_log_module_add_membuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__log__common.html#gad41859c2eab8886cfdebb82ac5ba1f8d">M_log_t</a> *&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">M_uint64&#160;</td>
          <td class="paramname"><em>buf_time_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__log__common.html#gacfe40a05708b4c96cc13e85169b20743">M_log_expire_cb</a>&#160;</td>
          <td class="paramname"><em>expire_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>expire_thunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__log__common.html#gaa367697cdf319431c22adec6f4e08c53">M_log_module_t</a> **&#160;</td>
          <td class="paramname"><em>out_mod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a module to output to a buffer in memory.</p>
<p>This is intended for temporary, in-memory storage of sensitive data that can't be stored long-term.</p>
<p>Messages are accepted from the time the buffer is added, until the buffer is full. After that, no new messages are stored, and the contents are preserved until either the module is removed, or the expiration time is reached.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log</td><td>logger object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_size</td><td>max size (in bytes) of memory buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_time_s</td><td>max time (in seconds) to allow buffer to exist in memory before it's automatically deleted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">expire_cb</td><td>callback to call when a memory buffer is automatically deleted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">expire_thunk</td><td>any state used by the expire callback (not owned by log, you must delete it yourself) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_mod</td><td>handle for created module, or <code>NULL</code> if there was an error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

</div>
</div>
<a id="gadeab6519c8e80ef50edd2a6c46a57f15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadeab6519c8e80ef50edd2a6c46a57f15">&#9670;&nbsp;</a></span>M_log_module_take_membuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__log__common.html#gab5f4f197e827f0ecab0b79f0f2478672">M_log_error_t</a> M_log_module_take_membuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__log__common.html#gad41859c2eab8886cfdebb82ac5ba1f8d">M_log_t</a> *&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__log__common.html#gaa367697cdf319431c22adec6f4e08c53">M_log_module_t</a> *&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__buf.html#ga6c543ecf0004fc310faa23c6ed8b267f">M_buf_t</a> **&#160;</td>
          <td class="paramname"><em>out_buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a membuf module from the log and return the internal memory store.</p>
<p>This method should be used if you need to preserve the data stored in the buffer. If you just want to remove the module and you don't care about the memory buffer contents, you should call the normal <a class="el" href="group__m__log__common.html#ga4f2b7b9950081be84709e7e2db4504b9">M_log_module_remove()</a> function instead.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__m__log__common.html#ga4f2b7b9950081be84709e7e2db4504b9">M_log_module_remove</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log</td><td>logger object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">module</td><td>handle of module to operate on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_buf</td><td>buffer containing membuf data, or <code>NULL</code> if there was an error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 20 2018 12:46:13 for Mstdlib-1.0.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
