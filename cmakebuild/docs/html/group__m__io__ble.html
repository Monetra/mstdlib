<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mstdlib-1.0.0: Bluetooth LE (Low Energy) IO functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mstdlib-1.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__m__io__ble.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Bluetooth LE (Low Energy) IO functions<div class="ingroups"><a class="el" href="group__m__eventio.html">Event Based I/O Subsystem</a> &raquo; <a class="el" href="group__m__eventio__base.html">Base I/O subsystems</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga160a92372e31a502282a7a81e01b766f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__m__io__ble.html#gafa447c64d709dfcbe731a3695692fc04">M_io_ble_enum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a></td></tr>
<tr class="separator:ga160a92372e31a502282a7a81e01b766f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga4b55a7fbad9e0c4eaf609d7b0aeb93f7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a> { <br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7accf6129e087d546f30dfb69ff5d1b43b">M_IO_BLE_WTYPE_WRITE</a> = 0, 
<br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7ad8504bdd0202cfc4863c2d2f2421a7e3">M_IO_BLE_WTYPE_WRITENORESP</a>, 
<br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7a4a81473ebc759f08223e87c2880a5d9a">M_IO_BLE_WTYPE_REQVAL</a>, 
<br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7adb4772c391a89c7d256090408b432803">M_IO_BLE_WTYPE_REQRSSI</a>
<br />
 }</td></tr>
<tr class="separator:ga4b55a7fbad9e0c4eaf609d7b0aeb93f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafca547d077ba95755aca3592db88a6d9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gafca547d077ba95755aca3592db88a6d9">M_io_ble_rtype_t</a> { <br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#ggafca547d077ba95755aca3592db88a6d9a808c3323c4430d8deecc987e77e7114b">M_IO_BLE_RTYPE_READ</a> = 0, 
<br />
&#160;&#160;<a class="el" href="group__m__io__ble.html#ggafca547d077ba95755aca3592db88a6d9a3794d22409c83ed0b73e03c73d966f0e">M_IO_BLE_RTYPE_RSSI</a>
<br />
 }</td></tr>
<tr class="separator:gafca547d077ba95755aca3592db88a6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5a86e8322afb694600d6115720c8cb37"><td class="memItemLeft" align="right" valign="top">M_bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga5a86e8322afb694600d6115720c8cb37">M_io_ble_scan</a> (<a class="el" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *event, <a class="el" href="group__m__event.html#ga454e48a58bf322de6666c6d9e65c3b51">M_event_callback_t</a> callback, void *cb_data, M_uint64 timeout_ms)</td></tr>
<tr class="separator:ga5a86e8322afb694600d6115720c8cb37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa447c64d709dfcbe731a3695692fc04"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gafa447c64d709dfcbe731a3695692fc04">M_io_ble_enum</a> (void)</td></tr>
<tr class="separator:gafa447c64d709dfcbe731a3695692fc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc911caf7fae020e80483314367297be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gacc911caf7fae020e80483314367297be">M_io_ble_enum_destroy</a> (<a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum)</td></tr>
<tr class="separator:gacc911caf7fae020e80483314367297be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa81513e26c53d16d75ef998a8572dc01"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gaa81513e26c53d16d75ef998a8572dc01">M_io_ble_enum_count</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum)</td></tr>
<tr class="separator:gaa81513e26c53d16d75ef998a8572dc01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cae734ab32c0ceb2da6c5a15664e13f"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga3cae734ab32c0ceb2da6c5a15664e13f">M_io_ble_enum_name</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum, size_t idx)</td></tr>
<tr class="separator:ga3cae734ab32c0ceb2da6c5a15664e13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacafb4d42cf67726b2e3f34ce0c3f3a80"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gacafb4d42cf67726b2e3f34ce0c3f3a80">M_io_ble_enum_uuid</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum, size_t idx)</td></tr>
<tr class="separator:gacafb4d42cf67726b2e3f34ce0c3f3a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga736f6f661809eb4ca69cae0aa71fa7b1"><td class="memItemLeft" align="right" valign="top">M_bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga736f6f661809eb4ca69cae0aa71fa7b1">M_io_ble_enum_connected</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum, size_t idx)</td></tr>
<tr class="separator:ga736f6f661809eb4ca69cae0aa71fa7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa81a546ccac631531b8e5aa86cd8ba8a"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gaa81a546ccac631531b8e5aa86cd8ba8a">M_io_ble_enum_service_uuid</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum, size_t idx)</td></tr>
<tr class="separator:gaa81a546ccac631531b8e5aa86cd8ba8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga633e0b94bcda6d3ce2f5847293a28279"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__time.html#ga4a70f026dae39fde5310040a740351d2">M_time_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga633e0b94bcda6d3ce2f5847293a28279">M_io_ble_enum_last_seen</a> (const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum, size_t idx)</td></tr>
<tr class="separator:ga633e0b94bcda6d3ce2f5847293a28279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2959840fffe0831d1851e0cab4626814"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__io.html#ga2d3bea9aaa4491c3c8dad94cf24498a2">M_io_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> **io_out, const char *uuid, M_uint64 timeout_ms)</td></tr>
<tr class="separator:ga2959840fffe0831d1851e0cab4626814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac54443e69b72bbe58f9ad00536bcdb73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__io.html#ga2d3bea9aaa4491c3c8dad94cf24498a2">M_io_error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gac54443e69b72bbe58f9ad00536bcdb73">M_io_ble_set_notify</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, const char *service_uuid, const char *characteristic_uuid, M_bool enable)</td></tr>
<tr class="separator:gac54443e69b72bbe58f9ad00536bcdb73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4b09595db7db269bf09517806ffb73a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__list__str.html#ga6de38b5604cb0dee336dccb52b5ae077">M_list_str_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gad4b09595db7db269bf09517806ffb73a">M_io_ble_get_services</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io)</td></tr>
<tr class="separator:gad4b09595db7db269bf09517806ffb73a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16bbbbf9842a4b07302eef536d6f05ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__list__str.html#ga6de38b5604cb0dee336dccb52b5ae077">M_list_str_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga16bbbbf9842a4b07302eef536d6f05ce">M_io_ble_get_service_characteristics</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, const char *service_uuid)</td></tr>
<tr class="separator:ga16bbbbf9842a4b07302eef536d6f05ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaddc03ff26e59f3cb74c86c31580d5078"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gaddc03ff26e59f3cb74c86c31580d5078">M_io_ble_get_max_write_sizes</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, size_t *with_response, size_t *without_response)</td></tr>
<tr class="separator:gaddc03ff26e59f3cb74c86c31580d5078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga769f8bf59271b5812a24dd817b260676"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga769f8bf59271b5812a24dd817b260676">M_io_ble_meta_get_service</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta)</td></tr>
<tr class="separator:ga769f8bf59271b5812a24dd817b260676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51c1ad36b870a95c2c00b60b961beea7"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga51c1ad36b870a95c2c00b60b961beea7">M_io_ble_meta_get_charateristic</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta)</td></tr>
<tr class="separator:ga51c1ad36b870a95c2c00b60b961beea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad46ca968f3d322898fea90eac3818e54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gad46ca968f3d322898fea90eac3818e54">M_io_ble_meta_get_write_type</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta)</td></tr>
<tr class="separator:gad46ca968f3d322898fea90eac3818e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga420beb176106ca6905a3156689d8b5d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__m__io__ble.html#gafca547d077ba95755aca3592db88a6d9">M_io_ble_rtype_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga420beb176106ca6905a3156689d8b5d2">M_io_ble_meta_get_read_type</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta)</td></tr>
<tr class="separator:ga420beb176106ca6905a3156689d8b5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c5405dc33555875cf9782e23652eb7f"><td class="memItemLeft" align="right" valign="top">M_bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga8c5405dc33555875cf9782e23652eb7f">M_io_ble_meta_get_rssi</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta, M_int64 *rssi)</td></tr>
<tr class="separator:ga8c5405dc33555875cf9782e23652eb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab02e3ad2ccd243ce6e994ef4ab6fc50d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gab02e3ad2ccd243ce6e994ef4ab6fc50d">M_io_ble_meta_set_service</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta, const char *service_uuid)</td></tr>
<tr class="separator:gab02e3ad2ccd243ce6e994ef4ab6fc50d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9fa5c479c7409045d6f1c3122e95056"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#gaf9fa5c479c7409045d6f1c3122e95056">M_io_ble_meta_set_characteristic</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta, const char *characteristic_uuid)</td></tr>
<tr class="separator:gaf9fa5c479c7409045d6f1c3122e95056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1884f2b80b9eb2c0df3b9ab44fbf6b00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__m__io__ble.html#ga1884f2b80b9eb2c0df3b9ab44fbf6b00">M_io_ble_meta_set_write_type</a> (<a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *meta, <a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a> type)</td></tr>
<tr class="separator:ga1884f2b80b9eb2c0df3b9ab44fbf6b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Bluetooth LE (Low Energy) IO functions.</p>
<p>Supported OS:</p><ul>
<li>iOS</li>
<li>macOS</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>iOS also supports an Apple proprietary system known as Made for iPhone/iPod/iPad (MFi). MFi uses ble but is handled differently. It's supposed though the m_io_mfi layer. MFi is also known as the External Accessory / EAAccessory protocol.</dd></dl>
<h2>Overview</h2>
<p>BLE was designed to keep energy consumption to a minimum and allow for seamless device access. Unlike Bluetooth classic, devices are not paired to the system. Typical use is to scan for available devices, inspect their services, and connect to a device that provides services the application wants to use. A good example is a heart rate monitor.</p>
<p>A health app doesn't care which heart rate monitor is being used it only cares about getting hear rate data. Typically, the user will be presented with a list of suitable devices in case multiple devices are detected (for example, multiple people going on a bike ride together).</p>
<p>Since there is no pairing the device much be found by scanning for available devices. This happen in two ways. First M_io_ble_scan will look for and cache devices that can be seen by the OS. During a scan, stale devices (over 15 minutes old) will be removed.</p>
<p>All devices that have been found during a scan (excluding ones that have been pruned) be listed as part of device enumeration. This means devices may no longer be present. Such as an iPhone being seen during scanning and later the owner of the phone leaving the room. There are no OS level events to notify that this has happened. At which point the seen device cache may be stale.</p>
<p>The other way a scan can be initiated is by trying to connect to a device that has not been seen. Opening a device requires specifying the UUID of the device and if not found a scan will be started internally for either the duration of the timeout or until the device has been found. This can cause a delay between trying to open a device and receiving CONNECT or ERROR events.</p>
<p>BLE devices provide services and there can be multiple services. Services provide characteristics and there can be multiple characteristics per service. Both services and characteristics can be defined using standardized profiles. See the Bluetooth GATT specifications.</p>
<p>Since there are multiple, potentially, read and write end points it is required to specify the service and characteristic UUIDs. A write event much have them specified using the M_io_meta_t and associated BLE meta functions. A read will fill a provided meta object with the service and characteristic the data came from. This means only the read and write meta functions can be use with BLE. The none-meta functions will return an error.</p>
<p>Characteristics can have multiple properties.</p><ul>
<li>Read</li>
<li>Notify</li>
<li>Indicate</li>
<li>Write</li>
<li>Write without response</li>
</ul>
<p>BLE by default is not a stream based protocol like serial, HID, or Bluetooth classic. Characteristics with the read property can be requested to read data. This is an async request. M_io_ble facilitates this by using M_io_write_meta with a property indicator that specifies data is not being written but a request for read is being sent.</p>
<p>Characteristics with the notify or indicate property can be subscribed to which will have them issue read events similar to a stream protocol. Reads will still require a meta object to specify which service and characteristic the data is from. Manual read requests may still be necessary. Notify and Indicate events are left to the device to imitate. The device may have internal rules which limit how often events are triggered. For example a heart rate monitor could notify every 2 seconds even though it's reading every 100 ms. A time service might send an event every second or it might send an event every minute.</p>
<p>Characteristics won't receive read events be default. They need to be subscribed to first. Subscripts will not service a disconnect or destroy of an io object. Also, not all characteristics support this property even if it supports read. Conversely some support notify/indicate but not read.</p>
<p>Write will write data to the device and the OS will issue an event whether the write as successful or failed. Mstdlib uses this to determine if there was a write error and will block subsequent writes (returns WOULDBLOCK) until an outstanding write has completed.</p>
<p>Write without response is a blind write. No result is requested from the OS. The state of the write is not known after it is sent.</p>
<h2>macOS requirements</h2>
<p>BLE events are only delivered to the main run loop. This is a design decision by Apple. It is not possible to use an different run loop to receive events like can be done with classic Bluetooth or HID. BLE events are none blocking so there shouldn't be performance impact with the events being delivered. As little work as possible is performed during event processing to limit any impact of this design requirement.</p>
<p>A C application will need to manually start the macOS main runloop otherwise no events will be delivered and no BLE operations will work.</p>
<h3>Examples</h3>
<h4>Application that scans for 30 seconds and enumerates all devices and their services that were seen.</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_enum.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> scan_done_cb(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *event, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> type, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *cb_arg)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum;</div><div class="line">    <span class="keywordtype">size_t</span>           len;</div><div class="line">    <span class="keywordtype">size_t</span>           i;</div><div class="line"></div><div class="line">    (void)event;</div><div class="line">    (void)type;</div><div class="line">    (void)io;</div><div class="line">    (void)cb_arg;</div><div class="line"></div><div class="line">    btenum = <a class="code" href="group__m__io__ble.html#gafa447c64d709dfcbe731a3695692fc04">M_io_ble_enum</a>();</div><div class="line"></div><div class="line">    len = <a class="code" href="group__m__io__ble.html#gaa81513e26c53d16d75ef998a8572dc01">M_io_ble_enum_count</a>(btenum);</div><div class="line">    <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;Num devs = %zu\n&quot;</span>, len);</div><div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;len; i++) {</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;Device:\n&quot;</span>);</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;\tName: %s\n&quot;</span>, <a class="code" href="group__m__io__ble.html#ga3cae734ab32c0ceb2da6c5a15664e13f">M_io_ble_enum_name</a>(btenum, i));</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;\tUUID: %s\n&quot;</span>, <a class="code" href="group__m__io__ble.html#gacafb4d42cf67726b2e3f34ce0c3f3a80">M_io_ble_enum_uuid</a>(btenum, i));</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;\tConnected: %s\n&quot;</span>, <a class="code" href="group__m__io__ble.html#ga736f6f661809eb4ca69cae0aa71fa7b1">M_io_ble_enum_connected</a>(btenum, i)?<span class="stringliteral">&quot;Yes&quot;</span>:<span class="stringliteral">&quot;No&quot;</span>);</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;\tLast Seen: %llu\n&quot;</span>, <a class="code" href="group__m__io__ble.html#ga633e0b94bcda6d3ce2f5847293a28279">M_io_ble_enum_last_seen</a>(btenum, i));</div><div class="line">        <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;\tSerivce: %s\n&quot;</span>, <a class="code" href="group__m__io__ble.html#gaa81a546ccac631531b8e5aa86cd8ba8a">M_io_ble_enum_service_uuid</a>(btenum, i));</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io__ble.html#gacc911caf7fae020e80483314367297be">M_io_ble_enum_destroy</a>(btenum);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">        CFRunLoopStop(mrl);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga5a86e8322afb694600d6115720c8cb37">M_io_ble_scan</a>(el, scan_done_cb, NULL, 30000);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <span class="comment">// 5 sec timeout.</span></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that scans for 30 seconds and connects to a specified device which has been seen and cached (hopefully).</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_connect.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *io;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(io);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(io);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> scan_done_cb(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *event, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> type, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *cb_arg)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *btenum;</div><div class="line">    <span class="keywordtype">size_t</span>           len;</div><div class="line">    <span class="keywordtype">size_t</span>           i;</div><div class="line"></div><div class="line">    (void)event;</div><div class="line">    (void)type;</div><div class="line">    (void)io;</div><div class="line">    (void)cb_arg;</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;io, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, io, events, NULL);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;SCAN DONE\n&quot;</span>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga5a86e8322afb694600d6115720c8cb37">M_io_ble_scan</a>(el, scan_done_cb, NULL, 5000);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that implicitly scans and connects to a specified device which has not been seen and cached.</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_connect_noscan.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *io;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga02a1aa7eee8d2fb2e7fdc189f33e649e">M_io_disconnect</a>(io);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(io);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;io, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, io, events, NULL);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that reads by polling the device for a read using a write</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_readp.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *dio;</div><div class="line"><a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a>  *wmeta;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    M_int64      rssi  = M_INT64_MIN;</div><div class="line">    <a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *rmeta = NULL;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>  *service_uuid;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>  *characteristic_uuid;</div><div class="line">    <span class="keywordtype">char</span>         msg[256];</div><div class="line">    <span class="keywordtype">size_t</span>       len;</div><div class="line"></div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, NULL, 0, NULL, wmeta);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">            rmeta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">            <a class="code" href="group__m__io.html#ga19356ecc08acdc8557d315c7457fe075">M_io_read_meta</a>(dio, msg, <span class="keyword">sizeof</span>(msg)-1, &amp;len, rmeta);</div><div class="line">            msg[len]            = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line">            service_uuid        = <a class="code" href="group__m__io__ble.html#ga769f8bf59271b5812a24dd817b260676">M_io_ble_meta_get_service</a>(dio, rmeta);</div><div class="line">            characteristic_uuid = <a class="code" href="group__m__io__ble.html#ga51c1ad36b870a95c2c00b60b961beea7">M_io_ble_meta_get_charateristic</a>(dio, rmeta);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;%s - %s: %s\n&quot;</span>, service_uuid, characteristic_uuid, msg);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(rmeta);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__thread__common__create.html#gad157454b4bc8ece94d2c02e3a3c5b3a0">M_thread_sleep</a>(100000);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, NULL, 0, NULL, wmeta);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga3e1f56ec1e586649c1b26eb7c72238de">M_io_get_error_string</a>(dio, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;ERROR: %s\n&quot;</span>, msg);</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <span class="keywordflow">if</span> (etype == <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>)</div><div class="line">                <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(dio);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;dio, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    wmeta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">    <a class="code" href="group__m__io__ble.html#ga1884f2b80b9eb2c0df3b9ab44fbf6b00">M_io_ble_meta_set_write_type</a>(dio, wmeta, <a class="code" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7a4a81473ebc759f08223e87c2880a5d9a">M_IO_BLE_WTYPE_REQVAL</a>);</div><div class="line">    <a class="code" href="group__m__io__ble.html#gab02e3ad2ccd243ce6e994ef4ab6fc50d">M_io_ble_meta_set_service</a>(dio, wmeta, <span class="stringliteral">&quot;1111&quot;</span>);</div><div class="line">    <a class="code" href="group__m__io__ble.html#gaf9fa5c479c7409045d6f1c3122e95056">M_io_ble_meta_set_characteristic</a>(dio, wmeta, <span class="stringliteral">&quot;2222&quot;</span>);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, dio, events, NULL);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(wmeta);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that reads by requesting notification when value changes</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_readn.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *dio;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    M_int64      rssi  = M_INT64_MIN;</div><div class="line">    <a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *rmeta = NULL;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>  *service_uuid;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>  *characteristic_uuid;</div><div class="line">    <span class="keywordtype">char</span>         msg[256];</div><div class="line">    <span class="keywordtype">size_t</span>       len;</div><div class="line"></div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <span class="comment">// XXX: Set notify service and characteristic.</span></div><div class="line">            <a class="code" href="group__m__io__ble.html#gac54443e69b72bbe58f9ad00536bcdb73">M_io_ble_set_notify</a>(dio, <span class="stringliteral">&quot;1111&quot;</span>, <span class="stringliteral">&quot;2222&quot;</span>, M_TRUE);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">            rmeta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">            <a class="code" href="group__m__io.html#ga19356ecc08acdc8557d315c7457fe075">M_io_read_meta</a>(dio, msg, <span class="keyword">sizeof</span>(msg), &amp;len, rmeta);</div><div class="line">            msg[len]            = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line">            service_uuid        = <a class="code" href="group__m__io__ble.html#ga769f8bf59271b5812a24dd817b260676">M_io_ble_meta_get_service</a>(dio, rmeta);</div><div class="line">            characteristic_uuid = <a class="code" href="group__m__io__ble.html#ga51c1ad36b870a95c2c00b60b961beea7">M_io_ble_meta_get_charateristic</a>(dio, rmeta);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;%s - %s: %s\n&quot;</span>, service_uuid, characteristic_uuid, msg);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(rmeta);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__thread__common__create.html#gad157454b4bc8ece94d2c02e3a3c5b3a0">M_thread_sleep</a>(100000);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga3e1f56ec1e586649c1b26eb7c72238de">M_io_get_error_string</a>(dio, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;ERROR: %s\n&quot;</span>, msg);</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <span class="keywordflow">if</span> (etype == <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>)</div><div class="line">                <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(dio);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;dio, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, dio, events, NULL);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that uses writes to request current RSSI value.</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_rssi.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *dio;</div><div class="line"><a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a>  *wmeta;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    M_int64      rssi  = M_INT64_MIN;</div><div class="line">    <a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *rmeta = NULL;</div><div class="line">    <span class="keywordtype">char</span>         msg[256];</div><div class="line"></div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, NULL, 0, NULL, wmeta);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">            rmeta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">            <a class="code" href="group__m__io.html#ga19356ecc08acdc8557d315c7457fe075">M_io_read_meta</a>(dio, NULL, 0, NULL, rmeta);</div><div class="line">            <a class="code" href="group__m__io__ble.html#ga8c5405dc33555875cf9782e23652eb7f">M_io_ble_meta_get_rssi</a>(dio, rmeta, &amp;rssi);</div><div class="line">            <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(rmeta);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;RSSI = %lld\n&quot;</span>, rssi);</div><div class="line"></div><div class="line">            <a class="code" href="group__m__thread__common__create.html#gad157454b4bc8ece94d2c02e3a3c5b3a0">M_thread_sleep</a>(100000);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, NULL, 0, NULL, wmeta);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga3e1f56ec1e586649c1b26eb7c72238de">M_io_get_error_string</a>(dio, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;ERROR: %s\n&quot;</span>, msg);</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <span class="keywordflow">if</span> (etype == <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>)</div><div class="line">                <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(dio);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;dio, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    wmeta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">    <a class="code" href="group__m__io__ble.html#ga1884f2b80b9eb2c0df3b9ab44fbf6b00">M_io_ble_meta_set_write_type</a>(dio, wmeta, <a class="code" href="group__m__io__ble.html#gga4b55a7fbad9e0c4eaf609d7b0aeb93f7adb4772c391a89c7d256090408b432803">M_IO_BLE_WTYPE_REQRSSI</a>);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, dio, events, NULL);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(wmeta);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h4>Application that writes</h4>
<div class="fragment"><div class="line"><span class="comment">// Build:</span></div><div class="line"><span class="comment">// clang -g -fobjc-arc -framework CoreFoundation test_ble_write.c -I ../../include/ -L ../../build/lib/ -l mstdlib_io -l mstdlib_thread -l mstdlib</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Run:</span></div><div class="line"><span class="comment">// DYLD_LIBRARY_PATH=&quot;../../build/lib/&quot; ./a.out</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_thread.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/mstdlib_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mstdlib/io/m_io_ble.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a>    *el;</div><div class="line"><a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a>       *dio;</div><div class="line"><a class="code" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a>  *meta;</div><div class="line">CFRunLoopRef  mrl = NULL;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> events(<a class="code" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *el, <a class="code" href="group__m__event.html#ga66b039653a61c8702310d03e6ba69802">M_event_type_t</a> etype, <a class="code" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *io, <span class="keywordtype">void</span> *thunk)</div><div class="line">{</div><div class="line">    <span class="keywordtype">size_t</span>        len = 0;</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num = 1;</div><div class="line">    <span class="keywordtype">char</span>          msg[256];</div><div class="line">    <a class="code" href="group__m__io.html#ga2d3bea9aaa4491c3c8dad94cf24498a2">M_io_error_t</a>  ret;</div><div class="line"></div><div class="line">    (void)el;</div><div class="line">    (void)io;</div><div class="line">    (void)thunk;</div><div class="line"></div><div class="line">    <a class="code" href="group__m__fmt.html#ga148cb889ab2737a09ebf313e7a3d454b">M_snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;%zu&quot;</span>, num++);</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (etype) {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7ab0fc60e031020cb3f36b70c4932d67f2">M_EVENT_TYPE_CONNECTED</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;CONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)msg, <a class="code" href="group__m__str__check.html#gabebfa875d1ada2b43f52b9344b0844d0">M_str_len</a>(msg), &amp;len, meta);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a8d2cf32ca08773c695e988635ebfd426">M_EVENT_TYPE_READ</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a1713e94c1e0750f168d255f580fd4ad9">M_EVENT_TYPE_WRITE</a>:</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;WRITE\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga6c9882ef33a5098dca5bfc5808707859">M_io_write_meta</a>(dio, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)msg, <a class="code" href="group__m__str__check.html#gabebfa875d1ada2b43f52b9344b0844d0">M_str_len</a>(msg), &amp;len, meta);</div><div class="line">            <a class="code" href="group__m__thread__common__create.html#gad157454b4bc8ece94d2c02e3a3c5b3a0">M_thread_sleep</a>(100000);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7adce269f93799cdca69ac20235895d0ac">M_EVENT_TYPE_ERROR</a>:</div><div class="line">            <a class="code" href="group__m__io.html#ga3e1f56ec1e586649c1b26eb7c72238de">M_io_get_error_string</a>(dio, msg, <span class="keyword">sizeof</span>(msg));</div><div class="line">            <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;ERROR: %s\n&quot;</span>, msg);</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>:</div><div class="line">            <span class="keywordflow">if</span> (etype == <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a6cead05362ca89b2cc7353bf6b4c2c6e">M_EVENT_TYPE_DISCONNECTED</a>)</div><div class="line">                <a class="code" href="group__m__fmt.html#gae54b252ea2bcf34b09ef1fa0f134ffa8">M_printf</a>(<span class="stringliteral">&quot;DISCONNECTED!!!\n&quot;</span>);</div><div class="line">            <a class="code" href="group__m__io.html#ga1532f13c1f01fc1521b68a0f1d61c864">M_io_destroy</a>(dio);</div><div class="line">            <span class="keywordflow">if</span> (mrl != NULL)</div><div class="line">                CFRunLoopStop(mrl);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a571c000a93b3c198364a32e5e145f2d0">M_EVENT_TYPE_ACCEPT</a>:</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__m__event.html#gga5d54358d8088f050bcdb141c6c0b21e7a89a67d4e5f2bdcadc1ffa3ba0473a6cf">M_EVENT_TYPE_OTHER</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_el(<span class="keywordtype">void</span> *arg)</div><div class="line">{</div><div class="line">    (void)arg;</div><div class="line">    <a class="code" href="group__m__event.html#gab5e0ea9055833a684aee9587252ed5fd">M_event_loop</a>(el, M_TIMEOUT_INF);</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gaff7324b3e6d67d3479d047eb79beb06c">M_threadid_t</a>     el_thread;</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8365ddefe78fb767a9fc80347192b4ff">M_thread_attr_t</a> *tattr;</div><div class="line"></div><div class="line">    el = <a class="code" href="group__m__event.html#gae169dca80125767d87fe196f32ea8d74">M_event_create</a>(<a class="code" href="group__m__event.html#gga72bc04891ff7b6142b7672a207ae74b1ac7efcb61cf28fa27d4a0a3daf68aaecf">M_EVENT_FLAG_NONE</a>);</div><div class="line"></div><div class="line">    tattr = <a class="code" href="group__m__thread__common__create.html#gaffbb2d659ce017851e30f429a57fe607">M_thread_attr_create</a>();</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#gafce2d3e68ed6e4f3850225712cd63a7a">M_thread_attr_set_create_joinable</a>(tattr, M_TRUE);</div><div class="line">    el_thread = <a class="code" href="group__m__thread__common__create.html#ga21bd63f7d2c726646b7e3d62250c25c6">M_thread_create</a>(tattr, run_el, NULL);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga42671ffa9ae57de51f410b2cc8b011b4">M_thread_attr_destroy</a>(tattr);</div><div class="line"></div><div class="line">    <span class="comment">// XXX: Set the id to the device you want to connect to.</span></div><div class="line">    <a class="code" href="group__m__io__ble.html#ga2959840fffe0831d1851e0cab4626814">M_io_ble_create</a>(&amp;dio, <span class="stringliteral">&quot;92BD9AC6-3BC8-4B24-8BF8-AE583AFE3ED4&quot;</span>, 5000);</div><div class="line">    meta = <a class="code" href="group__m__io.html#ga82fb1edb0e33765b6bface193d91f304">M_io_meta_create</a>();</div><div class="line">    <a class="code" href="group__m__io__ble.html#gab02e3ad2ccd243ce6e994ef4ab6fc50d">M_io_ble_meta_set_service</a>(dio, meta, <span class="stringliteral">&quot;1111&quot;</span>);</div><div class="line">    <a class="code" href="group__m__io__ble.html#gaf9fa5c479c7409045d6f1c3122e95056">M_io_ble_meta_set_characteristic</a>(dio, meta, <span class="stringliteral">&quot;2222&quot;</span>);</div><div class="line">    <a class="code" href="group__m__event.html#ga755cf00991529e324be3f9f49a5d5476">M_event_add</a>(el, dio, events, NULL);</div><div class="line"></div><div class="line">    mrl = CFRunLoopGetCurrent();</div><div class="line">    CFRunLoopRun();</div><div class="line"></div><div class="line">    <a class="code" href="group__m__event.html#ga8fb286ac5ca7c7fedc1aa26fd4f640b4">M_event_done_with_disconnect</a>(el, 5*1000);</div><div class="line">    <a class="code" href="group__m__thread__common__create.html#ga8fdc6d5a069b6d9ca601ffe9753e0355">M_thread_join</a>(el_thread, NULL);</div><div class="line"></div><div class="line">    <a class="code" href="group__m__io.html#ga7586ea2e66889f608975ce17f96e6298">M_io_meta_destroy</a>(meta);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <h2 class="groupheader">Typedef Documentation</h2>
<a id="ga160a92372e31a502282a7a81e01b766f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga160a92372e31a502282a7a81e01b766f">&#9670;&nbsp;</a></span>M_io_ble_enum_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="group__m__io__ble.html#gafa447c64d709dfcbe731a3695692fc04">M_io_ble_enum</a> <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga4b55a7fbad9e0c4eaf609d7b0aeb93f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">&#9670;&nbsp;</a></span>M_io_ble_wtype_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Meta property types used by M_io_write_meta.</p>
<p>Specifies how the write should function. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga4b55a7fbad9e0c4eaf609d7b0aeb93f7accf6129e087d546f30dfb69ff5d1b43b"></a>M_IO_BLE_WTYPE_WRITE&#160;</td><td class="fielddoc"><p>Normal write. Waits for confirmation data was written before writes can take place again. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4b55a7fbad9e0c4eaf609d7b0aeb93f7ad8504bdd0202cfc4863c2d2f2421a7e3"></a>M_IO_BLE_WTYPE_WRITENORESP&#160;</td><td class="fielddoc"><p>Write without confirmation response. Blind write. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4b55a7fbad9e0c4eaf609d7b0aeb93f7a4a81473ebc759f08223e87c2880a5d9a"></a>M_IO_BLE_WTYPE_REQVAL&#160;</td><td class="fielddoc"><p>Request value for service and characteristic. Not an actual write but a pseudo write to poll for a read event. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4b55a7fbad9e0c4eaf609d7b0aeb93f7adb4772c391a89c7d256090408b432803"></a>M_IO_BLE_WTYPE_REQRSSI&#160;</td><td class="fielddoc"><p>Request RSSI value. </p>
</td></tr>
</table>

</div>
</div>
<a id="gafca547d077ba95755aca3592db88a6d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafca547d077ba95755aca3592db88a6d9">&#9670;&nbsp;</a></span>M_io_ble_rtype_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__m__io__ble.html#gafca547d077ba95755aca3592db88a6d9">M_io_ble_rtype_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Meta types used by M_io_read_meta.</p>
<p>Specifies what type of read is being returned. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggafca547d077ba95755aca3592db88a6d9a808c3323c4430d8deecc987e77e7114b"></a>M_IO_BLE_RTYPE_READ&#160;</td><td class="fielddoc"><p>Regular read of data from service and characteristic. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggafca547d077ba95755aca3592db88a6d9a3794d22409c83ed0b73e03c73d966f0e"></a>M_IO_BLE_RTYPE_RSSI&#160;</td><td class="fielddoc"><p>RSSI data read. Use M_io_ble_meta_get_rssi. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5a86e8322afb694600d6115720c8cb37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a86e8322afb694600d6115720c8cb37">&#9670;&nbsp;</a></span>M_io_ble_scan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_bool M_io_ble_scan </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__event.html#ga747f0301bfcc6db3b51eaf07e2582350">M_event_t</a> *&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__event.html#ga454e48a58bf322de6666c6d9e65c3b51">M_event_callback_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">M_uint64&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a BLE scan.</p>
<p>A scan needs to take place for nearby devices to be found. Once found they will appear in an enumeration.</p>
<p>Opening a known device does not require explicitly scanning. Scanning will happen implicitly if the device has not been seen before.</p>
<dl class="section warning"><dt>Warning</dt><dd>On macOS the callback will never be called if the main event loop is not running!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">event</td><td>Event handle to receive scan events. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">callback</td><td>User-specified callback to call when the scan finishes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cb_data</td><td>Optional. User-specified data supplied to user-specified callback when executed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_ms</td><td>How long the scan should run before stopping. 0 will default to 1 minute. Scanning for devices can take a long time. During testing of a simple pedometer times upwards of 50 seconds were seen before the device was detected while sitting 6 inches away. A maximum of 5 minutes is allowed. Any amount larger will be reduced to the max.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>M_TRUE if the scan was started and the callback will be called. Otherwise M_FALSE, the callback will not be called. </dd></dl>

</div>
</div>
<a id="gafa447c64d709dfcbe731a3695692fc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafa447c64d709dfcbe731a3695692fc04">&#9670;&nbsp;</a></span>M_io_ble_enum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a>* M_io_ble_enum </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a ble enumeration object.</p>
<p>You must call M_io_ble_scan to populate the enumeration. Failing to do so will result in an empty enumeration.</p>
<p>Use to determine what ble devices are connected and what services are being offered. This is a list of associated devices not necessarily what's actively connected.</p>
<p>The enumeration is based on available services. Meaning a device may be listed multiple times if it exposes multiple services.</p>
<dl class="section return"><dt>Returns</dt><dd>Bluetooth enumeration object. </dd></dl>

</div>
</div>
<a id="gacc911caf7fae020e80483314367297be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacc911caf7fae020e80483314367297be">&#9670;&nbsp;</a></span>M_io_ble_enum_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void M_io_ble_enum_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroy a ble enumeration object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa81513e26c53d16d75ef998a8572dc01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa81513e26c53d16d75ef998a8572dc01">&#9670;&nbsp;</a></span>M_io_ble_enum_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t M_io_ble_enum_count </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of ble objects in the enumeration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Count of ble devices. </dd></dl>

</div>
</div>
<a id="ga3cae734ab32c0ceb2da6c5a15664e13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3cae734ab32c0ceb2da6c5a15664e13f">&#9670;&nbsp;</a></span>M_io_ble_enum_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* M_io_ble_enum_name </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Name of ble device as reported by the device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Index in ble enumeration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String. </dd></dl>

</div>
</div>
<a id="gacafb4d42cf67726b2e3f34ce0c3f3a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacafb4d42cf67726b2e3f34ce0c3f3a80">&#9670;&nbsp;</a></span>M_io_ble_enum_uuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* M_io_ble_enum_uuid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>UUID of ble device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Index in ble enumeration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String. </dd></dl>

</div>
</div>
<a id="ga736f6f661809eb4ca69cae0aa71fa7b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga736f6f661809eb4ca69cae0aa71fa7b1">&#9670;&nbsp;</a></span>M_io_ble_enum_connected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_bool M_io_ble_enum_connected </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Whether the device is connected.</p>
<p>This does not mean it is currently in use. It means the device is present and connected to the OS. This is mainly a way to determine if a device in the enumeration is still within range and can be used.</p>
<p>Not all systems are able to report the connected status making this function less useful than you would think.</p>
<dl class="section return"><dt>Returns</dt><dd>M_TRUE if the device is connected, otherwise M_FALSE. If it is not possible to determine the connected status this function will return M_TRUE. </dd></dl>

</div>
</div>
<a id="gaa81a546ccac631531b8e5aa86cd8ba8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa81a546ccac631531b8e5aa86cd8ba8a">&#9670;&nbsp;</a></span>M_io_ble_enum_service_uuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* M_io_ble_enum_service_uuid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Uuid of service reported by device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Index in ble enumeration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String. </dd></dl>

</div>
</div>
<a id="ga633e0b94bcda6d3ce2f5847293a28279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga633e0b94bcda6d3ce2f5847293a28279">&#9670;&nbsp;</a></span>M_io_ble_enum_last_seen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__time.html#ga4a70f026dae39fde5310040a740351d2">M_time_t</a> M_io_ble_enum_last_seen </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__m__io__ble.html#ga160a92372e31a502282a7a81e01b766f">M_io_ble_enum_t</a> *&#160;</td>
          <td class="paramname"><em>btenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Last time the device was seen.</p>
<p>Run a scan to ensure this is up to date. Opening a device will also update the last seen time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">btenum</td><td>Bluetooth enumeration object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Index in ble enumeration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time. </dd></dl>

</div>
</div>
<a id="ga2959840fffe0831d1851e0cab4626814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2959840fffe0831d1851e0cab4626814">&#9670;&nbsp;</a></span>M_io_ble_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__io.html#ga2d3bea9aaa4491c3c8dad94cf24498a2">M_io_error_t</a> M_io_ble_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> **&#160;</td>
          <td class="paramname"><em>io_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">M_uint64&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a ble connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">io_out</td><td>io object for communication. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uuid</td><td>Required uuid of the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_ms</td><td>If the device has not already been seen a scan will be performed. This time out is how long we should wait to search for the device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result. </dd></dl>

</div>
</div>
<a id="gac54443e69b72bbe58f9ad00536bcdb73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac54443e69b72bbe58f9ad00536bcdb73">&#9670;&nbsp;</a></span>M_io_ble_set_notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__io.html#ga2d3bea9aaa4491c3c8dad94cf24498a2">M_io_error_t</a> M_io_ble_set_notify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_uuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>characteristic_uuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">M_bool&#160;</td>
          <td class="paramname"><em>enable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Request read event's when the characteristic's value changes.</p>
<p>Not all characteristic's support notifications. If not supported polling with M_io_write_meta using M_IO_BLE_WTYPE_REQVAL is the only way to retrieve the current value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">service_uuid</td><td>UUID of service. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">characteristic_uuid</td><td>UUID of characteristic. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td>Receive notifications?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result </dd></dl>

</div>
</div>
<a id="gad4b09595db7db269bf09517806ffb73a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4b09595db7db269bf09517806ffb73a">&#9670;&nbsp;</a></span>M_io_ble_get_services()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__list__str.html#ga6de38b5604cb0dee336dccb52b5ae077">M_list_str_t</a>* M_io_ble_get_services </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a list of service UUIDs provided by the device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of strings. </dd></dl>

</div>
</div>
<a id="ga16bbbbf9842a4b07302eef536d6f05ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16bbbbf9842a4b07302eef536d6f05ce">&#9670;&nbsp;</a></span>M_io_ble_get_service_characteristics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__list__str.html#ga6de38b5604cb0dee336dccb52b5ae077">M_list_str_t</a>* M_io_ble_get_service_characteristics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_uuid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a list of characteristic UUIDs provided a service provided by the device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">service_uuid</td><td>UUID of service.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of strings. </dd></dl>

</div>
</div>
<a id="gaddc03ff26e59f3cb74c86c31580d5078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaddc03ff26e59f3cb74c86c31580d5078">&#9670;&nbsp;</a></span>M_io_ble_get_max_write_sizes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void M_io_ble_get_max_write_sizes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>with_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>without_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the maximum write sizes from an io object.</p>
<p>Queries the highest BLE layer in the stack, if there are more than one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">with_response</td><td>The maximum size that will receive a response. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">without_response</td><td>The maximum size that will not receive a response. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga769f8bf59271b5812a24dd817b260676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga769f8bf59271b5812a24dd817b260676">&#9670;&nbsp;</a></span>M_io_ble_meta_get_service()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* M_io_ble_meta_get_service </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the service associated with a meta object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UUID </dd></dl>

</div>
</div>
<a id="ga51c1ad36b870a95c2c00b60b961beea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga51c1ad36b870a95c2c00b60b961beea7">&#9670;&nbsp;</a></span>M_io_ble_meta_get_charateristic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* M_io_ble_meta_get_charateristic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the characteristic associated with a meta object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UUID </dd></dl>

</div>
</div>
<a id="gad46ca968f3d322898fea90eac3818e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad46ca968f3d322898fea90eac3818e54">&#9670;&nbsp;</a></span>M_io_ble_meta_get_write_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a> M_io_ble_meta_get_write_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the write type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>type. </dd></dl>

</div>
</div>
<a id="ga420beb176106ca6905a3156689d8b5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga420beb176106ca6905a3156689d8b5d2">&#9670;&nbsp;</a></span>M_io_ble_meta_get_read_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__m__io__ble.html#gafca547d077ba95755aca3592db88a6d9">M_io_ble_rtype_t</a> M_io_ble_meta_get_read_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the read type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>type. </dd></dl>

</div>
</div>
<a id="ga8c5405dc33555875cf9782e23652eb7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c5405dc33555875cf9782e23652eb7f">&#9670;&nbsp;</a></span>M_io_ble_meta_get_rssi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_bool M_io_ble_meta_get_rssi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">M_int64 *&#160;</td>
          <td class="paramname"><em>rssi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the RSSI value from an RSSI read.</p>
<p>RSSI value is in decibels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rssi</td><td>RSSI value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>M_TRUE if RSSI read. Otherwise, M_FALSE. </dd></dl>

</div>
</div>
<a id="gab02e3ad2ccd243ce6e994ef4ab6fc50d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab02e3ad2ccd243ce6e994ef4ab6fc50d">&#9670;&nbsp;</a></span>M_io_ble_meta_set_service()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void M_io_ble_meta_set_service </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_uuid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the service associated with a meta object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">service_uuid</td><td>UUID of service. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf9fa5c479c7409045d6f1c3122e95056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9fa5c479c7409045d6f1c3122e95056">&#9670;&nbsp;</a></span>M_io_ble_meta_set_characteristic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void M_io_ble_meta_set_characteristic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>characteristic_uuid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the characteristic associated with a meta object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">characteristic_uuid</td><td>UUID of characteristic. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1884f2b80b9eb2c0df3b9ab44fbf6b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1884f2b80b9eb2c0df3b9ab44fbf6b00">&#9670;&nbsp;</a></span>M_io_ble_meta_set_write_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void M_io_ble_meta_set_write_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga845c131d8520206a2a7a9219d1bd1932">M_io_t</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io.html#ga9b9493ef60e89fbb37537ec239ab2724">M_io_meta_t</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__m__io__ble.html#ga4b55a7fbad9e0c4eaf609d7b0aeb93f7">M_io_ble_wtype_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set whether a write should be blind.</p>
<p>If the type is not set, the default is to have writes wait for confirmation response before subsequent writes will be allowed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td>io object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Meta. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Property controlling </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 20 2018 12:46:13 for Mstdlib-1.0.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
